<script>
    // Funzione per caricare e visualizzare i dati
    async function loadData() {
      try {
        const response = await fetch('https://script.google.com/macros/s/AKfycbw6-L0DhySH_wGQ7Ea3zcB03tdwOPpbBveVdfbFqPji95JcWpreJwABRdacPpiuMzYUJw/exec');
        const data = await response.json();
        
        // Per ogni foglio nel response
        Object.keys(data).forEach(sheetName => {
          const tableContainer = document.getElementById(`${sheetName}-table`);
          if (!tableContainer) return;
          
          const rows = data[sheetName];
          if (rows.length === 0) return;
          
          // Ottieni tutte le colonne dal primo record
          const columns = Object.keys(rows[0]);
          
          // Crea la tabella
          let table = `
            <table class="table">
              <thead>
                <tr>
                  ${columns.map(col => `<th>${col}</th>`).join('')}
                  <th>Azioni</th>
                </tr>
              </thead>
              <tbody>
          `;
          
          // Aggiungi le righe
          rows.forEach(row => {
            table += '<tr>';
            columns.forEach(col => {
              let cellValue = row[col] || '';
              // Formatta le date se necessario
              if (cellValue instanceof Date) {
                cellValue = cellValue.toLocaleDateString('it-IT');
              }
              table += `<td>${cellValue}</td>`;
            });
            table += `
              <td>
                <button class="btn btn-sm btn-danger" onclick="deleteRow('${sheetName}', ${row._rowIndex})">
                  Elimina
                </button>
              </td>
            </tr>`;
          });
          
          table += '</tbody></table>';
          tableContainer.innerHTML = table;
        });
        
      } catch (error) {
        console.error('Errore nel caricamento dei dati:', error);
        alert('Errore nel caricamento dei dati');
      }
    }
    
    // Carica i dati all'avvio
    document.addEventListener('DOMContentLoaded', loadData);
    </script>